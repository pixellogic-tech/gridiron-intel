import{Request as Q,Response as S,NextFunction as N}from'express';import{ProprietaryAuth as A}from'../auth/ProprietaryAuth';export interface AuthRequest extends Q{user?:{id:number;email:string;role:string}}export const authenticateToken=(q:AuthRequest,s:S,n:N)=>{const t=q.headers['authorization']?.split(' ')[1];if(!t)return s.status(401).json({error:'Token required'});try{q.user=A.verify(t);n()}catch(e){return s.status(403).json({error:'Invalid token'})}};
